<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Named Entity Recognition In Malayalam | Aman K. Shihab</title> <meta name="author" content="Aman K. Shihab"> <meta name="description" content="State-of-the-art monolingual Named Entity Recognition in Malayalam"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website aman aman-k-shihab machine-learning deep-learning computer-vision natural-language-processing"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/about/assets/css/main.css"> <link rel="canonical" href="https://alshedivat.github.io/about/blog/2023/mal-ner/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/about/assets/js/theme.js"></script> <script src="/about/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/about/"><span class="font-weight-bold">Aman </span>K. Shihab</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/about/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/about/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/about/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/about/cv/">résumé</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Named Entity Recognition In Malayalam</h1> <p class="post-meta">March 20, 2023</p> <p class="post-tags"> <a href="/about/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/about/blog/category/natural-language-processing"> <i class="fas fa-tag fa-sm"></i> natural-language-processing</a>   <a href="/about/blog/category/named-entity-recognition"> <i class="fas fa-tag fa-sm"></i> named-entity-recognition</a>   <a href="/about/blog/category/malayalam"> <i class="fas fa-tag fa-sm"></i> malayalam</a>   <a href="/about/blog/category/deep-learning"> <i class="fas fa-tag fa-sm"></i> deep-learning</a>   <a href="/about/blog/category/pytorch"> <i class="fas fa-tag fa-sm"></i> pytorch</a>   <a href="/about/blog/category/huggingface"> <i class="fas fa-tag fa-sm"></i> huggingface</a>   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"><a href="#what-is-named-entity-recognition">What is named entity recognition?</a></li> <li class="toc-entry toc-h1"><a href="#why-is-ner-in-malayalam-challenging">Why is NER in Malayalam Challenging?</a></li> <li class="toc-entry toc-h1"> <a href="#the-dataset">The Dataset</a> <ul> <li class="toc-entry toc-h2"><a href="#preprocessing">Preprocessing</a></li> </ul> </li> <li class="toc-entry toc-h1"><a href="#tokenization">Tokenization</a></li> <li class="toc-entry toc-h1"> <a href="#model-architectures">Model Architectures</a> <ul> <li class="toc-entry toc-h2"><a href="#rnn">RNN</a></li> <li class="toc-entry toc-h2"><a href="#bilstm">BiLSTM</a></li> <li class="toc-entry toc-h2"><a href="#transformer">Transformer</a></li> </ul> </li> <li class="toc-entry toc-h1"><a href="#how-i-adressed-the-tag-imbalances">How I adressed the tag imbalances?</a></li> <li class="toc-entry toc-h1"><a href="#concluding-thoughts-and-future-work">Concluding Thoughts and Future Work</a></li> </ul> </div> <hr> <div id="markdown-content"> <h1 id="what-is-named-entity-recognition">What is named entity recognition?</h1> <p>Starting with the most obvious question, what exactly is Named Entity Recognition? Named Entity Recognition (NER) is a natural language processing (NLP) technique that involves identifying and categorizing named entities within a given text. Named entities refer to specific words or phrases that represent real-world objects such as people, organizations, locations, dates, quantities, and more. NER systems aim to automatically extract and classify these entities to understand the underlying structure and meaning of a text. The following is an illustration of NER in English from <a href="https://huggingface.co/dslim/bert-base-NER" rel="external nofollow noopener" target="_blank">this</a> huggingface space which uses a bert-base model.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/about/assets/blog-images/ner-blog/ner-english-example-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/about/assets/blog-images/ner-blog/ner-english-example-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/about/assets/blog-images/ner-blog/ner-english-example-1400.webp"></source> <img src="/about/assets/blog-images/ner-blog/ner-english-example.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>When we approach this task in Malayalam we are faced with certain challenges that arise due to the inherent nature of the language. In this blog post, I’ll be describing the various deep learning approaches that I experimented with and offer my explanation as to why these work.</p> <p>All the code and models that resulted from this work is available at <a href="https://github.com/amankshihab/TENER-MALAYALAM" rel="external nofollow noopener" target="_blank"></a></p> <h1 id="why-is-ner-in-malayalam-challenging">Why is NER in Malayalam Challenging?</h1> <p>The first and fundamental problem is the availability of data. This is mainly due to the limited digital footprint when compared to English. This makes scraping data from the web difficult as they do not yield data in sufficient quantities. Recently however, the AI4Bharat initiative by IIT Madras released a large dataset named <a href="https://ai4bharat.iitm.ac.in/naamapadam" rel="external nofollow noopener" target="_blank">Naamapadam</a>, which is currently the largest publicly available NER dataset for a large collection of indic languages. I’ll be expanding more on the dataset further down the blog.</p> <p>Malayalam, like other Dravidian languages, exhibits intricate word forms and affixation patterns, making it challenging to identify and classify named entities accurately. One aspect of morphological complexity in Malayalam is the phenomenon of sandhi, which involves the fusion or alteration of word boundaries when words are combined. Consider the words “ആനയും” (aanayum) and “ഉണ്ടെന്ന്” (undennu), which mean “elephant” and “exists” respectively. When these words are combined, a sandhi rule comes into play, resulting in changes to the word boundaries and phonetic forms. The combination of “ആനയും” (aanayum) and “ഉണ്ടെന്ന്” (undennu) results in “ആനയുമുണ്ടെന്ന്” (aanayumundennu), meaning “elephant exists.” Recognizing named entities that undergo sandhi requires the NER system to handle these changes accurately, segmenting and recognizing the individual words within the combined form.</p> <p>Another challenge arises from the extensive use of inflectional suffixes and prefixes in Malayalam. Words in Malayalam can undergo modifications to indicate tense, gender, number, case, and other grammatical features. For example, consider the word “കാരന്‍” (kaaran), which means “person” in Malayalam. The word can undergo various changes depending on the grammatical context. In the plural form, it becomes “കാരന്മാര്‍” (kaaranmaar), and in the genitive case, it becomes “കാരന്റെ” (kaarante). Recognizing the different inflected forms of a named entity requires the NER system to handle these variations and understand the underlying morphological rules.</p> <p>Additionally, the use of placenames, honorifics and titles in Malayalam further adds to the morphological complexity. Respectful and honorific terms are commonly used in addressing individuals, especially in formal contexts. These honorifics may modify or precede the names of individuals, requiring the NER system to understand their variations and incorporate them into the recognition process.</p> <h1 id="the-dataset">The Dataset</h1> <p>As mentioned earlier, I used <a href="https://ai4bharat.iitm.ac.in/naamapadam" rel="external nofollow noopener" target="_blank">Naamapadam</a>, by AI4Bharat here. It contains 717k sentences in the train split, 3.62k in the validation split, and 974 sentences in its test split. It contains person (PER), location (LOC), organization (ORG), and Other(O) as entities. The way the authors generated this large dataset is clever. They took <a href="https://ai4bharat.iitm.ac.in/samanantar" rel="external nofollow noopener" target="_blank">Samanantar</a> which is a parallel corpus of English and Indic languages. They tag the English side of this corpora using a high-quality off-the-shelf NER model. Then they align the words using learned word alignment approaches to align the English words with their indic counterparts and they ended up with decent-sized tagged corpora for NER.</p> <p>Before modeling the dataset, I was curious to find out the distribution of the tags. So I did a little bit of visualization and found severe imbalances, which are shown below.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/about/assets/blog-images/ner-blog/dataset-distribution-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/about/assets/blog-images/ner-blog/dataset-distribution-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/about/assets/blog-images/ner-blog/dataset-distribution-1400.webp"></source> <img src="/about/assets/blog-images/ner-blog/dataset-distribution.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>I apologize for the numerical classes, here’s the map ( 0 = Other, 1 = B-PER, 2 = I-PER, 3 = B-ORG, 4 = I-ORG, 5 = B-LOC, 6 = I-LOC ), B = Beginning, I = Inside.</p> <p>The O (Other) class is very dominant in count compared to the rest of the classes. So we’ll need to explore some methods to handle that as well. I’ll be explaining my approach to solving this further down the blog.</p> <h2 id="preprocessing">Preprocessing</h2> <p>Certain standard NLP preprocessing steps were applied to the sentences before they were modeled. All the punctuation was removed. The tags were realigned to account for the splits that occur when the word is tokenized. The code for all the preprocessing steps is available in my GitHub repository.</p> <h1 id="tokenization">Tokenization</h1> <p>I have chosen to use byte pair encoding (BPE) here. It has proven to be powerful since its debut in the original GPT paper. BPE splits the text into individual characters and then iteratively merges the most common pairs. So most frequently occurring pairs get merged and have their tokens. This provides a perfect middle ground between character-level and word-level tokenizations. Now this method does not account for sandhi, this is one area of research that might be fruitful to all Malayalam nlp tasks. I used a pre-trained tokenization and vectorization from <a href="https://bpemb.h-its.org/" rel="external nofollow noopener" target="_blank">BPEmb</a>.</p> <h1 id="model-architectures">Model Architectures</h1> <p>I evaluated through three main architectures, namely RNN, LSTM, and Transformer. Out of the three LSTM and Tranformers gave the best results. Both BiLSTM and Transformer models are available on my <a href="https://github.com/amankshihab/TENER-MALAYALAM" rel="external nofollow noopener" target="_blank">github page</a></p> <h2 id="rnn">RNN</h2> <p>Since NER is a sequence modeling task, my first choice was the RNN. I also wanted to get a sense of how it performed with RNNs before moving forward with other model architectures. I used a 3 layers RNN with ReLU activation and a dropout of 0.3. During the first epoch of training, the loss was going down and everything was going the way it should be. But around halfway into the epoch, the loss spiked suddenly. I suspected the learning rate might have been too high and experimented with various values, but the issue persisted. The next place I went looking was at the gradients of the layers. This is when I realized that the gradient values were too big and I encountered “Exploding gradients”. Then I explored ways to eliminate the numerical stabilities in the model.</p> <p>I modified the weight initialization strategy, the weights were initialized randomly at first. I then moved to use Kaiming Normal Initialization. In Kaiming Normal initialization, the weights of each layer are sampled from a normal distribution with zero mean and variance calculated based on the fan-in of the layer. The fan-in represents the number of input connections to a neuron or a layer. The variance is adjusted to ensure that the signals neither vanish nor explode as they propagate through the network. this delayed the exploding gradients but did not solve the problem fully.</p> <p>Another thing that was missing from my initial RNN model was a normalization layer. So I added a layer norm layer from Pytorch. The reasoning was the normalization layers scale the activations and keep them in a desired range so that they neither explode nor vanish. But in my case, it did not solve the problem.</p> <h2 id="bilstm">BiLSTM</h2> <p>Which is when I moved onto LSTM with the same configurations as the RNN. This move immediately solved all of the numerical instabilities as expected and the model was successfully trained. Which is when the thought of experimenting with BiLSTM came about. During my literature survey before embarking on this project, I observed that BiLSTMs were quite popular for NER in many other languages. I went ahead and trained a BiLSTM with the same data and obtained a well-trained model which has an F1-score of 0.96 on the test set and test loss of 0.09 and only 2.49M trainable parameters.</p> <h2 id="transformer">Transformer</h2> <p>Transformers have been in the limelight ever since they first debuted back in 2017. It became even more popular when Large Language Models (LLM) like BERT and GPT came along both of which use the encoder and decoder parts of the transformers respectively. The architecture of the transformer especially with the self-attention layer provides a global context of the incoming vectors.</p> <p>The architecture I chose was a two-layer encoder-only transformer model, which was trained from scratch. The model did not exhibit any numerical instabilities and it was successfully trained. This obtained an F1-score of 0.98 on the test set and a test loss of 0.05 and has 4.25M trainable parameters. This model performs slightly better than BiLSTM on some corpus, overall the transformer model is still preferred for high levels of accuracy.</p> <h1 id="how-i-adressed-the-tag-imbalances">How I adressed the tag imbalances?</h1> <p>Imbalanced datasets are not a new phenomenon in machine learning. All the real-world datasets are often very imbalanced. This topic has been talked about and researched quite a lot and as a result of those several well-defined approaches exist to solve the class imbalance problem. Oversampling is one method that increases the no. of data points of the underrepresented class. Undersampling is another method that reduces the no. of data points of the overrepresented class.</p> <p>However, these methods cannot be applied here directly. Let’s take a look at a sentence from the dataset.</p> <div class="text-center"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/about/assets/blog-images/ner-blog/dataset-example-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/about/assets/blog-images/ner-blog/dataset-example-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/about/assets/blog-images/ner-blog/dataset-example-1400.webp"></source> <img src="/about/assets/blog-images/ner-blog/dataset-example.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Undersampling or oversampling would mean removing some words from the dataset. This would not make any sense as the sentence will be deformed when we do that, essentially we’ll be removing our features and that’s never good when we’re modelling. This constraint turned my focus to weighted loss functions.</p> <p>The loss function I used was the very familiar cross-entropy loss, but with a slight modification, I provide weights to each of the classes manually. So, overrepresented classes, are scaled-down and underrepresented ones are scaled up, this helps the learning by focusing lesser on the overrepresented classes and focusing more on the underrepresented classes.</p> <h1 id="concluding-thoughts-and-future-work">Concluding Thoughts and Future Work</h1> <p>The transformer model shown here achieves the best result so far based on F1-score (open to discussion and further tests). However, some more things need to be addressed. First of all, even though sandhi was mentioned I did not make any active efforts to address it presently. Some methods that come to my mind are to just split these words in the corpus using a sandhi splitter and then proceed with tokenization, this method needs to be evaluated.</p> <p>Text augmentation was one avenue that I wanted to explore, but practically it became a bit tedious since some sentences became grammatically incorrect. When addressed it might give more generalization power to the models.</p> <p>The weights to the weighted loss function were assigned by me manually, but a more systematic way of assigning weights might yield better performance. One idea I had in mind was to have learnable weights, but whether it’s a sane idea or not is subject to speculation.</p> <p>I encountered a paper that shows that training a multilingual NER model can improve the performance of the model even further. So training a multilingual NER model using the same architecture on all the languages provided by the dataset is a very plausible idea that I am working on currently.</p> <p>Once these flaws are addressed we will have a very performant model for NER tasks in Malayalam.</p> </div> </article><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"alshedivat/al-folio","data-repo-id":"MDEwOlJlcG9zaXRvcnk2MDAyNDM2NQ==","data-category":"Comments","data-category-id":"DIC_kwDOA5PmLc4CTBt6","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,a])=>giscusScript.setAttribute(t,a)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Aman K. Shihab. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/about/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/about/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/about/assets/js/no_defer.js"></script> <script defer src="/about/assets/js/common.js"></script> <script defer src="/about/assets/js/copy_code.js" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>